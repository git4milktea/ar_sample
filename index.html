<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,intial-scale=1">
        <title>WebAR</title>
    </head>
    
    
    <body style="margin:0px; overflow:hidden;">
        
        <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
        <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>

        <script type="text/javascript">
        function request_permission(){
         if (
             DeviceMotionEvent &&
             DeviceMotionEvent.requestPermission &&
             typeof DeviceMotionEvent.requestPermission === 'function'
             ) {
                  DeviceMotionEvent.requestPermission();
             }
         if (
             DeviceOrientationEvent &&
             DeviceOrientationEvent.requestPermission &&
             typeof DeviceOrientationEvent.requestPermission === 'function'
            ) {
                 DeviceOrientationEvent.requestPermission();
            }
        }
        
        window.onload=request_permission
        </script>

        <script>
        AFRAME.registerComponent('registerevents', {
        init: function () {
        var marker = this.el;
        alert(marker.id + " reg");
        // 以下、マーカーを検出時のイベント
        marker.addEventListener('markerFound', function () {
           var markerId = marker.id;
           //a-text要素を生成する
           alert(marker.id + " found!");
           let dev_label_static = document.createElement("a-text");
           dev_label_static.id='dev_label_static';
           let scene = document.getElementById("room_scene");
           let dev_label = document.getElementById("dev_label");
           alert(scene.id + " is got!");
           alert(dev_label.id + " is got!");
           //dev_label_staticをa-sceneに追加する
           dev_label_static.setAttribute("id", "dev_label_static");
           dev_label_static.setAttribute('value', 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
           dev_label_static.setAttribute('position', '0 2.5 0');
           dev_label_static.setAttribute('align', 'center');
           dev_label_static.setAttribute('rotation', '0 0 0');
           dev_label_static.setAttribute('color', '#00aa55');
           scene.appendChild(dev_label_static);
//           scene.appendChild(dev_label);
        });
        }
        });
        </script>


        
        <a-scene id="room_scene" embedded arjs="debugUIEnabled:false;" vr-mode-ui="enabled: false">
<!--              <a-text id="dev_label" value="Hello AR!\n This is real." position="0 2 0" align="center" rotation="0 0 0" color="#000000">  
 -->             <a-text value="Hello AR!\n This is real." color="#000000">  
              </a-text>
            <a-entity camera></a-entity>
        </a-scene>
    </body>
</html>
